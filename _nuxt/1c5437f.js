(window.webpackJsonp=window.webpackJsonp||[]).push([[9,71],{1134:function(t,e,n){"use strict";n.r(e);n(8),n(7),n(4),n(9),n(10);var r=n(0),o=(n(22),n(47),n(68),n(2),n(6),n(14),n(12),n(174),n(24),n(35)),c=n(903),l=n.n(c);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={data:function(){return{dialog_document:!1,filter:{},document:{file:null,grade:[]},data:[],currentPage:1,perPage:10,search:""}},watch:{search:function(){this.currentPage=1,this.__GET()}},computed:f(f({},Object(o.b)("dictionary",["dic_grade"])),{},{role:function(){return this.$store.state.auth.user?this.$store.state.auth.user.role.name:""}}),methods:{_Save:function(){var t=this;this.$refs.formdocumentstudent.validate().then((function(e){if(e){var data=new FormData;if(t.document.grade.includes("for_all")){var a=[];t.dic_grade.forEach((function(element){a.push(element.id)})),data.append("grade",a)}else{var n=[];t.document.grade.forEach((function(element){n.push(element)})),data.append("grade",n)}data.append("academic_year",t.$route.params.id),t.document.file.name&&data.append("file",t.document.file);var r=t.document.id?t.document.id:"";t.$axios({method:r?"PATCH":"POST",url:r?"/document/".concat(r,"/"):"/document/",data:data}).then((function(){t.dialog_document=!1,t.$swal.fire({icon:"success",title:r?"Document is edited success.":"Document is added success.",confirmButtonText:"Ok",timer:1500}),t.__GET(),t.document.file=null,t.document.id=null,t.document.grade=[]}))}else console.log("AA")}))},__GET:function(){var t=this;this.$nextTick((function(){t.$axios.get("/document/?doc=student&page=".concat(t.currentPage,"&search=").concat(t.search)).then((function(e){t.data=e.data}))}))},FilterName:function(a){var t="";return a.forEach((function(element,i){0!=i?t=t+","+element.name:t+=element.name})),t},EditDocument:function(t){this.document.file=t.file,this.document.id=t.id;var a=[];t.grade.forEach((function(element){a.push(element.id)})),this.document.grade=a,this.dialog_document=!0},pageChanged:function(){this.__GET()},Cancel:function(){this.document.file=null,this.dialog_document=!1,this.document.grade=[]},DeleteDocument:function(t){var e=this;this.$axios.delete("/document/".concat(t)).then((function(){e.$swal.fire({icon:"success",title:"Document is deleted success.",confirmButtonText:"Ok",timer:1500}),e.__GET()})).catch((function(){e.$swal.fire({icon:"error",title:"Document is not deleted.",text:"Please try later!",confirmButtonText:"Ok",timer:1500})}))},Extname:function(t){try{var a=l.a.extname(t);return a=a.replace(".",""),n(904)("./".concat(a,".svg"))}catch(t){return null}}},mounted:function(){this.__GET()}},v=n(16),component=Object(v.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("header",{staticClass:"d-flex align-items-center mb-3"},[n("h4",[t._v("Documents for students")]),t._v(" "),n("div",{staticClass:"ml-auto d-flex align-items-center"},[n("el-input",{staticStyle:{"max-width":"300px"},attrs:{placeholder:"Search...",clear:"foniy-input",clearable:"","suffix-icon":"el-icon-search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.__GET2()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),["admin","super_admin","branch_admin"].includes(t.role)?n("b-button",{staticClass:"ml-2",staticStyle:{"min-width":"120px"},attrs:{variant:"success"},on:{click:function(e){t.dialog_document=!0}}},[n("i",{staticClass:"fas fa-plus-circle mr-1"}),t._v("\n                Upload\n            ")]):t._e()],1)]),t._v(" "),n("table",{staticClass:"table b-table"},[t._m(0),t._v(" "),n("tbody",t._l(t.data.results,(function(e,i){return n("tr",{key:i},[n("td",[n("a",{attrs:{href:e.file,target:"_blank",download:""}},[t.Extname(e.name)?n("img",{staticClass:"mr-2",staticStyle:{width:"20px"},attrs:{src:t.Extname(e.name),alt:""}}):n("i",{staticClass:"mdi mdi-file"}),t._v("\n                        "+t._s(e.name)+"\n                    ")])]),t._v(" "),n("td",[t._v(" "+t._s(t.FilterName(e.grade))+" ")]),t._v(" "),n("td",[n("div",{staticClass:"d-flex"},[["branch_admin"].includes(t.role)?n("i",{staticClass:"mdi cursor-pointer mdi-pencil",on:{click:function(n){return t.EditDocument(e)}}}):t._e(),t._v(" "),["branch_admin"].includes(t.role)?n("el-popconfirm",{staticClass:"ml-1",attrs:{"confirm-button-text":"OK","cancel-button-text":"No, Thanks","icon-color":"red",title:"Are you sure to delete this Document?"},on:{confirm:function(n){return t.DeleteDocument(e.id)}}},[n("i",{staticClass:"mdi cursor-pointer mdi-delete",attrs:{slot:"reference"},slot:"reference"})]):t._e(),t._v(" "),n("nuxt-link",{staticClass:"ml-1",attrs:{to:"/email/send?document_id="+e.id}},[n("i",{staticClass:"mdi mdi-share-variant"})])],1)])])})),0)]),t._v(" "),n("div",{staticClass:"dataTables_paginate paging_simple_numbers float-right mb-3"},[n("ul",{staticClass:"pagination pagination-rounded mb-0"},[n("b-pagination",{attrs:{"total-rows":t.data.count,"per-page":t.perPage},on:{change:t.pageChanged},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)]),t._v(" "),n("b-modal",{attrs:{size:"lg",id:"semester-view-modal",title:"Document file","no-close-on-backdrop":!0},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{size:"md",variant:"success"},on:{click:function(e){return t._Save()}}},[t._v("\n                Save\n            ")]),t._v(" "),n("b-button",{attrs:{size:"md"},on:{click:function(e){return t.Cancel()}}},[t._v(" Close ")])]},proxy:!0}]),model:{value:t.dialog_document,callback:function(e){t.dialog_document=e},expression:"dialog_document"}},[n("ValidationObserver",{ref:"formdocumentstudent"},[n("div",{staticClass:"school-create-form"},[n("div",{staticClass:"item"},[n("p",{staticClass:"mb-1"},[t._v("Upload document:")]),t._v(" "),n("ValidationProvider",{staticClass:"mr-2 w-full",attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("UploadFile",{class:{invalid:r[0]},attrs:{url:t.document.file},model:{value:t.document.file,callback:function(e){t.$set(t.document,"file",e)},expression:"document.file"}})]}}])})],1),t._v(" "),n("div",{staticClass:"item mt-3"},[n("h4",[t._v("Access")]),t._v(" "),n("b-checkbox",{attrs:{value:"for_all",title:"For all"},model:{value:t.document.grade,callback:function(e){t.$set(t.document,"grade",e)},expression:"document.grade"}},[t._v("\n                        For all grades\n                    ")]),t._v(" "),t.document.grade.includes("for_all")?t._e():[n("hr"),t._v(" "),n("b-form-checkbox-group",{model:{value:t.document.grade,callback:function(e){t.$set(t.document,"grade",e)},expression:"document.grade"}},t._l(t.dic_grade,(function(e){return n("b-checkbox",{key:e.id,staticClass:"mb-2",attrs:{value:e.id}},[t._v("\n                                "+t._s(e.name)+" - Class\n                            ")])})),1)]],2)])])],1)],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("File")]),t._v(" "),n("th",[t._v("Access")]),t._v(" "),n("th",{staticStyle:{width:"40px"}},[t._v("Actions")])])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{UploadFile:n(847).default})},844:function(t,e,n){var content=n(850);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(53).default)("33aef1bf",content,!0,{sourceMap:!1})},847:function(t,e,n){"use strict";n.r(e);n(22),n(12),n(25),n(47),n(68),n(2),n(42),n(43),n(848),n(526);var r={props:{full:Boolean,ext:{type:Array,default:function(){return[]}},url:{type:Array,default:function(){return""}}},data:function(){return{form:{file:null,url:""}}},computed:{role:function(){return this.$store.state.auth.user.role.name}},watch:{value:{handler:function(t){this.form.url=t},immediate:!0}},methods:{onFileChanged:function(t){var e=t.target.files[0].name.split(".").pop();if(!this.ext.length||this.ext.includes(e)){var n=t.target.files[0];this.$emit("input",n),this.$emit("changed"),this.form={file:n,url:URL.createObjectURL(n),name:n.name}}else this.$Swal.fire({title:"Error",text:"Allowed file formates: ".concat(this.ext),type:"error"})}}},o=(n(849),n(16)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.form.url||t.url?n("div",{staticClass:"w-full flex items-center justify-content-center uploadFile downloading-file "},[t.url?n("a",{staticClass:"flex-1",attrs:{href:t.form.url?t.form.url:t.url,target:"_blank"}},[t.form.file?n("div",[t._v("\n            "+t._s(t.form.name||"Download file")+"\n            "),n("i",{staticClass:"cursor-pointer ml-2 el-icon-download"})]):n("div",[t._v("\n            Download file "),n("i",{staticClass:"cursor-pointer ml-2 el-icon-download"})])]):n("a",{staticClass:"flex-1"},[t._v("\n        "+t._s(t.form.name)+"\n    ")]),t._v(" "),n("div",{staticClass:"hr"}),t._v(" "),n("div",{staticClass:"flex-1"},[n("label",{staticClass:"cursor-pointer m-0"},[n("span",[t._v(" Edit")]),t._v(" "),n("input",{ref:"file",attrs:{type:"file"},on:{change:t.onFileChanged}})])])]):n("div",{staticClass:"flex items-center",class:{"opacity-70":!!t.form.url}},[n("label",{staticClass:"uploadFile",class:{"w-full":t.full,"border-green":t.url}},[n("span",[t._v(t._s(t.form&&t.form.name?t.form.name:"Upload"))]),t._v(" "),n("svg",{attrs:{width:"22",height:"16",viewBox:"0 0 22 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.9995 0C13.9795 0 16.4455 2.174 16.9125 5.021C19.7565 5.233 21.9995 7.602 21.9995 10.5C21.9995 13.537 19.5365 16 16.4995 16H4.99951C2.23851 16 -0.000488281 13.761 -0.000488281 11C-0.000488281 8.239 2.23851 6 4.99951 6C4.99951 2.686 7.68651 0 10.9995 0ZM14.6815 8.598L14.8885 8.391C15.0835 8.196 15.0835 7.879 14.8885 7.684L11.3535 4.148C11.1555 3.95 10.8445 3.951 10.6465 4.148L7.11151 7.684C6.91551 7.879 6.91551 8.196 7.11151 8.391L7.31851 8.598C7.41151 8.692 7.53851 8.745 7.67151 8.745H8.99951V12.5C8.99951 12.776 9.22351 13 9.49951 13H12.4995C12.7765 13 12.9995 12.776 12.9995 12.5V8.745H14.3275C14.4605 8.745 14.5875 8.692 14.6815 8.598Z",fill:t.form.file?"#0FBE7B":"#333333"}})]),t._v(" "),n("input",{attrs:{type:"file"},on:{change:t.onFileChanged}})]),t._v(" "),t.url?n("a",{attrs:{href:t.url,target:"_blank",download:""}},[n("i",{staticClass:"cursor-pointer ml-2 el-icon-download"})]):t._e()])}),[],!1,null,"2f6e30fa",null);e.default=component.exports},849:function(t,e,n){"use strict";n(844)},850:function(t,e,n){var r=n(52)(!1);r.push([t.i,"input[type=file][data-v-2f6e30fa]{width:0;height:0;display:none}.downloading-file[data-v-2f6e30fa]{border-color:#0fbe7b!important;font-size:14px;cursor:auto!important}.downloading-file .hr[data-v-2f6e30fa]{margin:0 7px;height:100%;width:1px;background-color:silver}.downloading-file div[data-v-2f6e30fa]{cursor:pointer;line-height:normal!important;color:#0fbe7b}.downloading-file a[data-v-2f6e30fa],.downloading-file div[data-v-2f6e30fa]{text-align:center}.border-green[data-v-2f6e30fa]{border-color:#0fbe7b!important}.uploadFile[data-v-2f6e30fa]{cursor:pointer;overflow:hidden;display:flex;align-items:center;justify-content:space-between;background:#fff;border:.5px solid #d9d9d9;box-sizing:border-box;border-radius:.2rem;height:38px;padding:.75rem;width:156px}.uploadFile.w-full[data-v-2f6e30fa]{width:100%}.uploadFile span[data-v-2f6e30fa]{max-width:105px;overflow:hidden;font-style:normal;font-weight:400;font-size:.9375rem;line-height:38px;color:#8c8c8c}.uploadFile svg[data-v-2f6e30fa]{z-index:23}",""]),t.exports=r},903:function(t,e,n){(function(t){function n(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function filter(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}e.resolve=function(){for(var e="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var path=i>=0?arguments[i]:t.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(e=path+"/"+e,r="/"===path.charAt(0))}return(r?"/":"")+(e=n(filter(e.split("/"),(function(p){return!!p})),!r).join("/"))||"."},e.normalize=function(path){var t=e.isAbsolute(path),o="/"===r(path,-1);return(path=n(filter(path.split("/"),(function(p){return!!p})),!t).join("/"))||t||(path="."),path&&o&&(path+="/"),(t?"/":"")+path},e.isAbsolute=function(path){return"/"===path.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(filter(t,(function(p,t){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var o=r(t.split("/")),c=r(n.split("/")),l=Math.min(o.length,c.length),d=l,i=0;i<l;i++)if(o[i]!==c[i]){d=i;break}var f=[];for(i=d;i<o.length;i++)f.push("..");return(f=f.concat(c.slice(d))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(path){if("string"!=typeof path&&(path+=""),0===path.length)return".";for(var code=path.charCodeAt(0),t=47===code,e=-1,n=!0,i=path.length-1;i>=1;--i)if(47===(code=path.charCodeAt(i))){if(!n){e=i;break}}else n=!1;return-1===e?t?"/":".":t&&1===e?"/":path.slice(0,e)},e.basename=function(path,t){var e=function(path){"string"!=typeof path&&(path+="");var i,t=0,e=-1,n=!0;for(i=path.length-1;i>=0;--i)if(47===path.charCodeAt(i)){if(!n){t=i+1;break}}else-1===e&&(n=!1,e=i+1);return-1===e?"":path.slice(t,e)}(path);return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},e.extname=function(path){"string"!=typeof path&&(path+="");for(var t=-1,e=0,n=-1,r=!0,o=0,i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(47!==code)-1===n&&(r=!1,n=i+1),46===code?-1===t?t=i:1!==o&&(o=1):-1!==t&&(o=-1);else if(!r){e=i+1;break}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===e+1?"":path.slice(t,n)};var r="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(94))},904:function(t,e,n){var map={"./3ds.svg":913,"./aac.svg":914,"./ai.svg":915,"./avi.svg":916,"./bmp.svg":917,"./cad.svg":918,"./cdr.svg":919,"./css.svg":920,"./dat.svg":921,"./dll.svg":922,"./dmg.svg":923,"./doc.svg":924,"./docx.svg":925,"./eps.svg":926,"./fla.svg":927,"./flv.svg":928,"./gif.svg":929,"./html.svg":930,"./indd.svg":931,"./iso.svg":932,"./jpg.svg":933,"./js.svg":934,"./midi.svg":935,"./mov.svg":936,"./mp3.svg":937,"./mpg.svg":938,"./pdf.svg":939,"./php.svg":940,"./png.svg":941,"./ppt.svg":942,"./ps.svg":943,"./psd.svg":944,"./raw.svg":945,"./sql.svg":946,"./svg.svg":947,"./tif.svg":948,"./txt.svg":949,"./wmv.svg":950,"./xls.svg":951,"./xlsx.svg":952,"./xml.svg":953,"./zip.svg":954};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}r.keys=function(){return Object.keys(map)},r.resolve=o,t.exports=r,r.id=904},913:function(t,e,n){t.exports=n.p+"img/3ds.83e8760.svg"},914:function(t,e,n){t.exports=n.p+"img/aac.3864cf1.svg"},915:function(t,e,n){t.exports=n.p+"img/ai.61d8fd7.svg"},916:function(t,e,n){t.exports=n.p+"img/avi.5790862.svg"},917:function(t,e,n){t.exports=n.p+"img/bmp.6d30a7b.svg"},918:function(t,e,n){t.exports=n.p+"img/cad.7af459c.svg"},919:function(t,e,n){t.exports=n.p+"img/cdr.20c124f.svg"},920:function(t,e,n){t.exports=n.p+"img/css.a8939b1.svg"},921:function(t,e,n){t.exports=n.p+"img/dat.1ba4cff.svg"},922:function(t,e,n){t.exports=n.p+"img/dll.2e549bc.svg"},923:function(t,e,n){t.exports=n.p+"img/dmg.5f15f1f.svg"},924:function(t,e,n){t.exports=n.p+"img/doc.3977eb0.svg"},925:function(t,e,n){t.exports=n.p+"img/docx.de7674a.svg"},926:function(t,e,n){t.exports=n.p+"img/eps.21bc14e.svg"},927:function(t,e,n){t.exports=n.p+"img/fla.f08ed94.svg"},928:function(t,e,n){t.exports=n.p+"img/flv.4d8b93a.svg"},929:function(t,e,n){t.exports=n.p+"img/gif.c2c85f1.svg"},930:function(t,e,n){t.exports=n.p+"img/html.1184cac.svg"},931:function(t,e,n){t.exports=n.p+"img/indd.1320ef2.svg"},932:function(t,e,n){t.exports=n.p+"img/iso.f70b920.svg"},933:function(t,e,n){t.exports=n.p+"img/jpg.46fc91d.svg"},934:function(t,e,n){t.exports=n.p+"img/js.fe31e8b.svg"},935:function(t,e,n){t.exports=n.p+"img/midi.f73c95c.svg"},936:function(t,e,n){t.exports=n.p+"img/mov.6f71ac2.svg"},937:function(t,e,n){t.exports=n.p+"img/mp3.22395da.svg"},938:function(t,e,n){t.exports=n.p+"img/mpg.c3c87f7.svg"},939:function(t,e,n){t.exports=n.p+"img/pdf.20a57c5.svg"},940:function(t,e,n){t.exports=n.p+"img/php.f382037.svg"},941:function(t,e,n){t.exports=n.p+"img/png.602dad0.svg"},942:function(t,e,n){t.exports=n.p+"img/ppt.ed1e8e8.svg"},943:function(t,e,n){t.exports=n.p+"img/ps.b4acc28.svg"},944:function(t,e,n){t.exports=n.p+"img/psd.e45dd95.svg"},945:function(t,e,n){t.exports=n.p+"img/raw.51bd9d7.svg"},946:function(t,e,n){t.exports=n.p+"img/sql.4e4de97.svg"},947:function(t,e,n){t.exports=n.p+"img/svg.0070a5c.svg"},948:function(t,e,n){t.exports=n.p+"img/tif.52b49ae.svg"},949:function(t,e,n){t.exports=n.p+"img/txt.f0b8f64.svg"},950:function(t,e,n){t.exports=n.p+"img/wmv.08ccbab.svg"},951:function(t,e,n){t.exports=n.p+"img/xls.e9d28df.svg"},952:function(t,e,n){t.exports=n.p+"img/xlsx.3d2b63f.svg"},953:function(t,e,n){t.exports=n.p+"img/xml.767e5bd.svg"},954:function(t,e,n){t.exports=n.p+"img/zip.047627e.svg"}}]);