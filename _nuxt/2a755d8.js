(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1015:function(e,t,n){"use strict";n(974)},1016:function(e,t,n){var l=n(52)(!1);l.push([e.i,".cascade-selector,.cascade-selector .el-cascader{width:100%}.cascade-selector .cascade-selector-item{margin-bottom:16px}.cascade-selector .cascade-selector-item p{margin:0 0 8px;font-size:16px;font-weight:600}.subject-type{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff}.subject-type.bg-blue{background:#08c}.subject-type.bg-primary{background:#66307f}.subject-type.bg-orange{background:#ffa10a}.subject-type.bg-green{background:#7ce883}",""]),e.exports=l},1041:function(e,t,n){"use strict";n.r(t);n(22),n(47),n(259),n(14),n(2),n(6),n(4);var l={props:["value"],computed:{role:function(){var e;return null===(e=this.$store.state.auth.user)||void 0===e?void 0:e.role.name},me:function(){return this.$store.state.auth.user}},data:function(){return{groups:"",users:[],options:[],all_parents:!1,all_teachers:!1,all_students:!1,senders:0,main_branch:[{link:"/users/student",label:"Student",value:0,disabled:!1,leaf:!1},{link:"/users/classteachershort",label:"Teachers",value:1,disabled:!1,leaf:!1},{link:"/users/classparent",label:"Parents",value:2,disabled:!1,leaf:!1}],ApiData:{student:[{link:"/users/classmate?limit=1000",label:"Classmates",value:0,disabled:!1,leaf:!1},{link:"/users/classteachershort?limit=1000'",label:"My Teachers",key:"",value:1,disabled:!1,leaf:!1}],parent:[{link:"/users/classteachershort",label:"Teachers",param:"children",value:0,disabled:!1,leaf:!1}]},roleKeys:{branch_admin:"A",teacher:"T",student:"S",parent:"P"},bgKeys:{branch_admin:"bg-green",teacher:"bg-blue",student:"bg-primary",parent:"bg-orange"}}},methods:{Load:function(e,t){["branch_admin","teacher"].includes(this.role)&&this.LoadBranchAdmin(e,t),["student"].includes(this.role)&&this.LoadStudent(e,t),["parent"].includes(this.role)&&this.LoadParent(e,t)},LoadBranchAdmin:function(e,t){var n=this,l=e.level;if(1==l&&t(this.main_branch),2==l){var r=e.path[0],path=this.main_branch[e.value].link;this.$axios.get("".concat(path,"?group=").concat(r,"&limit=1000")).then((function(e){var data=[];n.groups=e.data.results,e.data.results.forEach((function(element){data.push({label:n.FioFinder(element),value:element.id,leaf:!0})})),t(data)})).catch((function(){t([])}))}},LoadStudent:function(e,t){var n=this;if(1==e.level){var path=this.ApiData.student[e.value].link,l=this.ApiData.student[e.value].key;this.$axios.get("".concat(path)).then((function(e){var data=[];n.groups=e.data.results,e.data.results.forEach((function(element){var e=l?element[l]:element;data.push({label:n.FioFinder(e),value:e.id,leaf:!0})})),t(data)})).catch((function(){t([])}))}},LoadParent:function(e,t){var n=this,l=e.level;if(1==l&&t([{label:"Teachers",value:0,leaf:!1}]),2==l){var path=this.ApiData.parent[e.value].link,r=e.path[0],c=this.ApiData.parent[e.value].key;this.$axios.get("".concat(path,"?children=").concat(r,"&limit=1000")).then((function(e){var data=[];n.groups=e.data.results,e.data.results.forEach((function(element){var e=c?element[c]:element;data.push({label:n.FioFinder(e),value:e.id,leaf:!0})})),t(data)})).catch((function(){t([])}))}},FioFinder:function(e){var t=e&&e.first_name?e.first_name:"",n=e&&e.last_name?e.last_name:"",l=e&&e.middle_name?e.middle_name:"";return t||n||l?t+" "+n+" "+l:""},getGroups:function(){var e=this;this.options=[],this.$axios.get("/groupshortnames/").then((function(t){e.groups=t.data,t.data.forEach((function(element){e.options.push({label:element.name,value:element.id})}))}))},getMychildren:function(){var e=this;this.$axios.get("/users/children").then((function(t){e.groups=t.data,t.data.forEach((function(element){e.options.push({label:e.FioFinder(element),value:element.id})}))}))},GenerateData:function(){var data=[];["branch_admin","teacher"].includes(this.role)?this.users.forEach((function(element){data.push(element[element.length-1])})):data.push(this.users[this.users.length-1]),this.senders=data.length,this.all_parents?(data.push("all_parents"),this.senders.length):data.filter((function(e){return"all_parents"!=e})),this.all_students?(data.push("all_students"),this.senders.length):data.filter((function(e){return"all_students"!=e})),this.all_teachers?(data.push("all_teachers"),this.senders.length):data.filter((function(e){return"all_teachers"!=e})),this.$emit("input",data)},LoadData:function(){["branch_admin","teacher"].includes(this.role)&&this.getGroups(),["student"].includes(this.role)&&(this.options=this.ApiData.student),["parent"].includes(this.role)&&this.getMychildren()}},watch:{all_parents:function(e){this.main_branch[2].disabled=e},all_teachers:function(e){this.main_branch[1].disabled=e},all_students:function(e){this.main_branch[0].disabled=e},role:function(){this.LoadData()}},mounted:function(){this.LoadData()}},r=(n(1015),n(16)),component=Object(r.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cascade-selector"},[n("div",{staticClass:"cascade-selector-item"},[n("p",[e._v("From:")]),e._v(" "),n("b-button",{staticClass:"btn-rounded mb-1 mr-1",attrs:{variant:"light"}},[n("div",{staticClass:"d-flex align-items-center"},[n("div",{staticClass:"subject-type mr-2",class:e.bgKeys[""+e.role]},[e._v("\n                    "+e._s(e.roleKeys[""+e.role])+"\n                ")]),e._v(" "),[e._v("\n                    "+e._s(e.FioFinder(e.me)?e.FioFinder(e.me):"You")+"\n                ")]],2)])],1),e._v(" "),["branch_admin"].includes(e.role)?n("div",{staticClass:"cascade-selector-item"},[n("p",[e._v("To")]),e._v(" "),n("el-checkbox",{staticClass:"mt-1",on:{change:function(t){return e.GenerateData()}},model:{value:e.all_students,callback:function(t){e.all_students=t},expression:"all_students"}},[e._v("To All Students")]),e._v(" "),n("el-checkbox",{staticClass:"mt-1",on:{change:function(t){return e.GenerateData()}},model:{value:e.all_teachers,callback:function(t){e.all_teachers=t},expression:"all_teachers"}},[e._v("To All Teachers")]),e._v(" "),n("el-checkbox",{staticClass:"mt-1",on:{change:function(t){return e.GenerateData()}},model:{value:e.all_parents,callback:function(t){e.all_parents=t},expression:"all_parents"}},[e._v("To All Parents")])],1):e._e(),e._v(" "),n("div",{staticClass:"cascade-selector-item"},[n("p",[e._v("Select User ("+e._s(e.senders)+")")]),e._v(" "),n("el-cascader",{attrs:{placeholder:"Select Sytstem Users",props:{multiple:["branch_admin","teacher"].includes(e.role),lazy:!0,lazyLoad:e.Load},options:e.options,"collapse-tags":!0,"show-all-levels":!1},on:{change:function(t){return e.GenerateData()}},model:{value:e.users,callback:function(t){e.users=t},expression:"users"}})],1)])}),[],!1,null,null,null);t.default=component.exports},974:function(e,t,n){var content=n(1016);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("0c61ba1e",content,!0,{sourceMap:!1})}}]);