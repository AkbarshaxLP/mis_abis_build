(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{1017:function(t,e,n){"use strict";n(976)},1018:function(t,e,n){var o=n(52)(!1);o.push([t.i,".time-table-dictionary{padding:10px}.time-table-dictionary-items{display:flex;margin-left:-10px;margin-right:-10px;flex-wrap:wrap}.time-table-dictionary-item{padding:0 10px 20px;width:50%}",""]),t.exports=o},1130:function(t,e,n){"use strict";n.r(e);n(8),n(7),n(4),n(9),n(10);var o=n(0),r=(n(2),n(6),n(22),n(76),n(171),n(35));function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function c(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d={props:["showDialog","modalId"],computed:c(c({},Object(r.b)("dictionary",["dic_branch","dic_academic_year","dic_grade","dic_role"])),{},{GadeList:function(){return this.dic_grade&&this.dic_grade.length?this.dic_grade:[]},busy_grade:function(){var data=[],t=this.form.index?this.form.index:-1;return this.TimeTableList.forEach((function(e,n){t!=n&&e.grade.forEach((function(t){data.push(t.id)}))})),data},role:function(){var t;return null===(t=this.$store.state.auth.user)||void 0===t?void 0:t.role.name}}),data:function(){return{show:!1,show2:!1,value1:null,value:null,editMethod:!1,form:{name:"",grade:[],index:-1},errorList:{grade:!1},TimeTableList:[],timetabledict:"",timetabledict_item:{para_groups:[]}}},watch:{showDialog:function(t){this.editMethod||(this.form={id:null,name:"",index:-1}),t||(this.editMethod=!1)},form:function(){this.errorList={}}},methods:{clearForm:function(){this.form={name:null,grade:[],index:-1}},_getList:function(){var t=this;this.$axios.get("/timetabledict/").then((function(e){var data=[];e.data.results.forEach((function(element){if(element.dicttime&&!element.dicttime.length)element.dicttime=[{para:"",start_time:null,end_time:null,type:"",edit:!0,delete:!1,para_groups:[]}];else{var t=[];element.dicttime.forEach((function(e){e.edit=!1,e.delete=!1,t.push(e)})),element.delete=!1,element.dicttime=t}data.push(element)})),t.TimeTableList=data}))},CreateTimeTable:function(){var t=this;this.$refs.form1.validate().then((function(e){if(e){var data=new FormData;data.append("name",t.form.name),data.append("grade",t.form.grade),t.form.id?t.$axios.patch("/timetabledict/".concat(t.form.id,"/"),data).then((function(){t.form={},t.show=!1,t._getList()})).catch((function(e){400==e.response.status&&(t.errorList.grade=!0)})):t.$axios.post("/timetabledict/",data).then((function(){t.form={},t.show=!1,t._getList()})).catch((function(e){400==e.response.status&&(t.errorList.grade=!0)}))}}))},DradesName:function(data){var t=[];return data.forEach((function(element){t.push(parseInt(element.name))})),t=t.sort((function(a,b){return a-b})),String(t)},AddTimeTableList:function(i){this.TimeTableList[i].dicttime.push({para:"",start:"",end:"",type:"",edit:!0})},DeleteTimeTableList:function(t,i,e){var n=this;t.id?(this.TimeTableList[i].dicttime[e].delete=!0,this.$axios.delete("/dict_time/".concat(t.id,"/")).then((function(){n.TimeTableList[i].dicttime.splice(e,1)}))):this.TimeTableList[i].dicttime.splice(e,1)},SaveEdit:function(t,e){var n=this;if(e.para_groups&&e.para_groups.length&&"Lesson"!=e.type)this.show2=!0,this.timetabledict_item=e,this.timetabledict=t;else{var data=new FormData;data.append("timetabledict",t),data.append("start_time",e.start_time),data.append("end_time",e.end_time),data.append("type",e.type),data.append("para",e.para),e.id?this.$axios.put("/dict_time/".concat(e.id,"/"),data).then((function(){n._getList()})):this.$axios.post("/dict_time/",data).then((function(){n._getList()}))}},SaveModal:function(t,e){var n=this,data=new FormData;data.append("timetabledict",t),data.append("start_time",e.start_time),data.append("end_time",e.end_time),data.append("type",e.type),data.append("para",e.para),this.$axios.post("/etimetabledeletebypara/",{para:e.para,dict_id:t}),e.id?this.$axios.put("/dict_time/".concat(e.id,"/"),data).then((function(){n._getList(),n.show2=!1})):this.$axios.post("/dict_time/",data).then((function(){n._getList(),n.show2=!1}))},OpenEditModal:function(t,i){var e=[];t.grade.forEach((function(element){e.push(element.id)})),this.form.id=t.id,this.form.name=t.name,this.form.grade=e,this.form.index=i,this.show=!0},DeleteTimeTableDic:function(t,i){var e=this;this.TimeTableList[i].delete=!0,this.$axios.delete("/timetabledict/".concat(t.id,"/")).then((function(){e._getList()})).catch((function(){e.TimeTableList[i].delete=!1}))},disabled_para_list:function(t){var data=[];return t.forEach((function(element){data.push(element.para)})),data}},mounted:function(){this._getList()}},m=(n(1017),n(16)),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"time-table-dictionary"},[n("h1",{staticClass:"font-20 mb-2 mt-2 font-weight-bold"},[t._v("\n       General Timetable Rules\n    ")]),t._v(" "),t.TimeTableList&&t.TimeTableList.length?n("div",{staticClass:"time-table-dictionary-items"},t._l(t.TimeTableList,(function(e,i){return n("div",{key:i,staticClass:"time-table-dictionary-item"},[n("div",{staticClass:"d-flex justify-content-between"},[n("h1",{staticClass:"font-16 font-weight-bold"},[t._v("  "+t._s(e.name)+" ( Grades:"+t._s(t.DradesName(e.grade))+")")]),t._v(" "),["branch_admin"].includes(t.role)?n("div",{staticClass:"d-flex align-items-center"},[n("button",{staticClass:"button simple font-16 font-weight-bold mr-1",on:{click:function(n){return t.OpenEditModal(e,i)}}},[n("i",{staticClass:"mdi mdi-pencil"})]),t._v(" "),e.delete?n("button",{staticClass:"button simple font-16 font-weight-bold color-red"},[n("i",{staticClass:"el-icon-loading"})]):n("el-popconfirm",{attrs:{"confirm-button-text":"OK","cancel-button-text":"No, Thanks",title:"Are you sure to delete this?"},on:{confirm:function(n){return t.DeleteTimeTableDic(e,i)}}},[n("button",{staticClass:"button simple font-16 font-weight-bold color-red",attrs:{slot:"reference"},slot:"reference"},[n("i",{staticClass:"mdi mdi-delete"})])])],1):t._e()]),t._v(" "),n("div",{staticClass:"foniy-table"},[n("table",{staticClass:"border-all"},[n("tr",{staticClass:"bg-gray"},[n("th",{staticClass:"text-center font-weight-bold"},[t._v(" Type")]),t._v(" "),n("th",{staticClass:"text-center font-weight-bold",staticStyle:{width:"150px"}},[t._v("Start")]),t._v(" "),n("th",{staticClass:"text-center font-weight-bold",staticStyle:{width:"150px"}},[t._v("End")]),t._v(" "),n("th",{staticClass:"text-center font-weight-bold",staticStyle:{width:"100px"}}),t._v(" "),["branch_admin"].includes(t.role)?n("td",{staticClass:"text-center font-weight-bold",staticStyle:{width:"80px"}},[t._v("Action")]):t._e()]),t._v(" "),t._l(e.dicttime,(function(o,r){return n("tr",{key:r},[n("td",[o.edit?n("el-select",{staticClass:"w-full foniy-select",attrs:{placeholder:"Type"},model:{value:o.type,callback:function(e){t.$set(o,"type",e)},expression:"timetble.type"}},[n("el-option",{attrs:{label:"Lesson",value:"Lesson"}}),t._v(" "),n("el-option",{attrs:{label:"Lunch",value:"Lunch"}}),t._v(" "),n("el-option",{attrs:{label:"Snack",value:"Snack"}})],1):n("p",{staticClass:"m-0 text-center"},[t._v(" "+t._s(o.type)+" ")])],1),t._v(" "),n("td",[o.edit?n("el-time-picker",{attrs:{"picker-options":{selectableRange:"06:00:00 - 20:00:00"},"value-format":"HH:mm",format:"HH:mm",fo:"",placeholder:"Start time"},model:{value:o.start_time,callback:function(e){t.$set(o,"start_time",e)},expression:"timetble.start_time"}}):n("p",{staticClass:"m-0 text-center"},[t._v(" "+t._s(o.start_time)+" ")])],1),t._v(" "),n("td",[o.edit?n("el-time-picker",{attrs:{"picker-options":{selectableRange:"06:00:00 - 20:00:00"},"value-format":"HH:mm",format:"HH:mm",placeholder:"End time"},model:{value:o.end_time,callback:function(e){t.$set(o,"end_time",e)},expression:"timetble.end_time"}}):n("p",{staticClass:"m-0 text-center"},[t._v(" "+t._s(o.end_time)+" ")])],1),t._v(" "),n("td",{staticClass:"text-center font-weight-bold"},[o.edit?n("el-select",{staticClass:"w-full foniy-select",attrs:{placeholder:"Para"},model:{value:o.para,callback:function(e){t.$set(o,"para",e)},expression:"timetble.para"}},t._l(12,(function(o){return n("el-option",{key:o,attrs:{label:o,value:o,disabled:t.disabled_para_list(e.dicttime).includes(o)}})})),1):t._e(),t._v(" "),o.edit?t._e():n("p",{staticClass:"m-0 text-center"},[t._v(" "+t._s(o.para)+" ")])],1),t._v(" "),["branch_admin"].includes(t.role)?n("td",[n("div",{staticClass:"d-flex justify-content-between"},[o.edit?n("button",{staticClass:"button simple font-16 font-weight-bold mr-1 color-green",on:{click:function(n){return t.SaveEdit(e.id,o)}}},[n("i",{staticClass:"mdi mdi-check-bold"})]):n("button",{staticClass:"button simple font-16 font-weight-bold mr-1",on:{click:function(t){o.edit=!0}}},[n("i",{staticClass:"mdi mdi-pencil"})]),t._v(" "),o.id?n("el-popconfirm",{attrs:{"confirm-button-text":"OK","cancel-button-text":"No, Thanks",title:"Are you sure to delete this?"},on:{confirm:function(e){return t.DeleteTimeTableList(o,i,r)}}},[n("button",{staticClass:"button simple font-16 font-weight-bold color-red",class:{disabled:o.delete},attrs:{slot:"reference",disabled:o.delete},slot:"reference"},[n("i",{staticClass:"mdi mdi-close-thick"})])]):n("button",{staticClass:"button simple font-16 font-weight-bold color-red",class:{disabled:o.delete},attrs:{disabled:o.delete},on:{click:function(e){return t.DeleteTimeTableList(o,i,r)}}},[n("i",{staticClass:"mdi mdi-close-thick"})])],1)]):t._e()])})),t._v(" "),["branch_admin"].includes(t.role)?n("tr",[n("td",{attrs:{colspan:"5"}},[n("div",{staticClass:"d-flex justify-content-center"},[n("b-button",{staticClass:"ml-1 font-20 font-weight-bold w-full",attrs:{size:"md",variant:"outline-success"},on:{click:function(e){return t.AddTimeTableList(i)}}},[n("i",{staticClass:"mdi mdi-plus-circle"})])],1)])]):t._e()],2)])])})),0):t._e(),t._v(" "),n("b-modal",{attrs:{id:t.modalId,title:"Add Timetable dictionary","title-class":"font-18","body-class":"p-4"},on:{hide:function(e){return t.clearForm()}},scopedSlots:t._u([{key:"modal-footer",fn:function(e){var o=e.cancel;return[n("b-button",{attrs:{size:"md"},on:{click:function(t){return o()}}},[t._v(" Cancel ")]),t._v(" "),n("b-button",{attrs:{size:"md",variant:"success"},on:{click:t.CreateTimeTable}},[t._v(" Save ")])]}}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("ValidationObserver",{ref:"form1"},[n("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[n("p",{staticClass:"mb-1"},[t._v("Name")]),t._v(" "),n("b-form-input",{staticClass:"mb-2",class:{invalid:o[0]},attrs:{type:"text",placeholder:"Name"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})]}}])}),t._v(" "),t.dic_grade&&t.dic_grade.length?n("ValidationProvider",{staticClass:" w-full",attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[n("p",{staticClass:"mb-1"},[t._v("Grades")]),t._v(" "),n("el-select",{staticClass:"w-full foniy-select",class:{invalid:o[0]||t.errorList.grade},attrs:{multiple:"",placeholder:"Choose grade"},model:{value:t.form.grade,callback:function(e){t.$set(t.form,"grade",e)},expression:"form.grade"}},t._l(t.GadeList,(function(e,i){return n("el-option",{key:i,attrs:{label:e.name,value:e.id,disabled:t.busy_grade.includes(e.id)}})})),1)]}}],null,!1,2756217056)}):t._e()],1)],1),t._v(" "),n("b-modal",{attrs:{id:"warning",title:"Warning!","title-class":"font-18","body-class":"p-3"},on:{hide:function(e){return t.clearForm()}},scopedSlots:t._u([{key:"modal-footer",fn:function(e){var o=e.cancel;return[n("b-button",{attrs:{size:"md"},on:{click:function(t){return o()}}},[t._v(" Cancel ")]),t._v(" "),n("b-button",{attrs:{size:"md",variant:"success"},on:{click:function(e){return t.SaveModal(t.timetabledict,t.timetabledict_item)}}},[t._v(" Save ")])]}}]),model:{value:t.show2,callback:function(e){t.show2=e},expression:"show2"}},[n("p",{staticClass:"m-0 mb-3 text-warning"},[t._v("If you change this lesson time to another time, the lessons of the following groups at this time will be automatically deleted. ")]),t._v(" "),n("p",{staticClass:"m-0 mb-2 front-weight-bold"},[t._v("Groups")]),t._v(" "),t._l(t.timetabledict_item.para_groups,(function(e,i){return n("a",{key:i,staticClass:"mr-1 text-decoration-underline",attrs:{href:"/groups/students/"+e.id+"?currentTab=2"}},[t._v("\n            "+t._s(e.name)+"\n        ")])}))],2)],1)}),[],!1,null,null,null);e.default=component.exports},976:function(t,e,n){var content=n(1018);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(53).default)("fe95b3bc",content,!0,{sourceMap:!1})}}]);