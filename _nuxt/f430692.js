(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{905:function(e,t,n){var content=n(971);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("f0699bb6",content,!0,{sourceMap:!1})},970:function(e,t,n){"use strict";n(905)},971:function(e,t,n){var r=n(52)(!1);r.push([e.i,".time-table-view .time-table-view-items{display:flex;flex-wrap:wrap;margin-right:-10px;margin-left:-10px}.time-table-view .time-table-view-item{width:50%;padding:10px}.time-table-view .empty-time-table{width:100%;height:300px;display:flex;align-items:center;justify-content:center}.time-table-view .el-dropdown{display:block!important}.general-lesson-name{display:block;width:100%}.timte-table-lesson{position:relative;padding:2px 0;width:100%;cursor:pointer}.timte-table-lesson .badge{position:absolute;right:2px;top:-10px;background:#fff;padding:2px;display:flex;align-items:center;justify-content:center;width:25px;height:25px;border-radius:50%;font-size:12px;color:#333;z-index:1;border:1px solid #5e5e5e;box-shadow:0 12px 48px rgba(26,33,52,.11)}.timte-table-lesson .deadline-text{width:100%;max-width:300px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.timte-table-lesson .deadline-text span{color:#333;font-size:12px!important}",""]),e.exports=r},998:function(e,t,n){"use strict";n.r(t);n(8),n(7),n(9),n(10);var r=n(0),l=(n(2),n(6),n(4),n(22),n(14),n(76),n(171),n(47),n(12),n(25),n(35)),c=n(5),o=n.n(c);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var _={props:["grade","id"],computed:d(d({},Object(l.b)("dictionary",["dic_academic_year"])),{},{semester_list:function(){var e=this,data=[];return this.dic_academic_year.forEach((function(element){element.current_academicyear&&(e.filter.academic_year=element.id,element.semesters.forEach((function(t){t.current_semester&&(e.filter.semester=t.id)})),data=element.semesters)})),data},cur_academic_year:function(){var data="";return this.dic_academic_year.forEach((function(element){element.current_academicyear&&(data=element.id)})),data},cur_semester:function(){var e=this,data="";return this.dic_academic_year.forEach((function(element){element.current_academicyear&&(e.filter.academic_year=element.id,element.semesters.forEach((function(e){e.current_semester&&(data=e.id)})))})),data},dic_list:function(){return this.TimeTabledic&&this.TimeTabledic.length?this.TimeTabledic.filter((function(element){return"Lesson"==element.type})):[]},role:function(){var e;return null===(e=this.$store.state.auth.user)||void 0===e?void 0:e.role.name}}),data:function(){return{title:"Timetable",items:[{text:"Timetable",href:"/timetable"},{text:"Group",active:!0}],loader:!1,TimeTableGroup:{},TimeTabledic:{},filter:{},Leesons:[],semester:"",academic_year:"",timeTableList:[],a:[],time_table_id:"",time_table_base:{id:7,academic_year:{id:11,name:"2022-2023"},semester:{id:13,start_semester:"05.09.2022",end_semester:"10.11.2022"},group:{id:23,name:"3 A"},etimetablelesson:[{weekday:"Monday",timetable:[{weekday:"Monday",etimetable:7,para:"",lesson:"",edit:!0,loading:!1}]},{weekday:"Tuesday",timetable:[{weekday:"Tuesday",etimetable:7,para:"",lesson:"",edit:!0,loading:!1}]},{weekday:"Wednesday",timetable:[{weekday:"Wednesday",etimetable:7,para:"",lesson:"",edit:!0,loading:!1}]},{weekday:"Thursday",timetable:[{weekday:"Thursday",etimetable:7,para:"",lesson:"",edit:!0,loading:!1}]},{weekday:"Friday",timetable:[{weekday:"Friday",etimetable:7,para:"",lesson:"",edit:!0,loading:!1}]},{weekday:"Saturday",timetable:[{weekday:"Saturday",etimetable:7,para:"",lesson:"",edit:!0,loading:!1}]}]}}},watch:{current_semester:function(){this.semester=this.cur_semester?this.cur_semester:this.semester_list[0].id},semester:function(){this._getList()}},methods:{_getList:function(){var e=this;this.loader=!0,this.semester=this.semester?this.semester:this.cur_semester,this.academic_year=this.academic_year?this.academic_year:this.cur_academic_year;var t=this.id?"/etimetablelist/?academic_year=".concat(this.academic_year,"&semester=").concat(this.semester,"&group=").concat(this.id):"/etimetablelist/?academic_year=".concat(this.academic_year,"&semester=").concat(this.semester);this.$axios.get(t).then((function(t){if(e.a=t.data,t.data&&t.data.etimetablelesson){var n=[];e.time_table_id=t.data.id;var r=new Date,l=0;r=o()(r).format("dddd"),t.data.etimetablelesson.forEach((function(element){if(null==element.timetable)n.push({weekday:element.weekday,current_day:element.weekday==r,timetable:[{weekday:element.weekday,etimetable:t.data.id,para:"",para_index:"",lesson:"",edit:!0,loading:!1,info:[]}]});else{var c=[];element.timetable.forEach((function(e){l+=1,c.push(d(d({},e),{},{lesson:e.lesson.id,subject_name:e.lesson.subject_name,main_teacher:e.lesson.main_teacher,teacher:e.lesson.teacher,para_index:l,info:e.info?e.info:[],edit:!1,loading:!1}))})),l=0,c=e.SortPara(c),n.push({current_day:element.weekday==r,weekday:element.weekday,timetable:c})}})),t.data.etimetablelesson=n,e.TimeTableGroup=t.data,e.generateTimeTable()}else e.TimeTableGroup=e.time_table_base,e.generateTimeTable()})).catch((function(){e.loader=!1}))},SortPara:function(e){return e.sort((function(a,b){return a.para>b.para?1:-1}))},_gettimetableDic:function(){var e=this;this.loader=!0,this.$axios.get("/timetabledict/").then((function(t){e.TimeTabledic=t.data.results[0].dicttime,e._getList()})).catch((function(){e.loader=!1}))},IssetPara:function(e){var data=[];return e.forEach((function(element){data.push(element.para)})),data},SubjectName:function(e){var data=e.subject_name;return e.main_teacher&&e.main_teacher.first_name&&(data=data+" | "+e.main_teacher.last_name+" "+e.main_teacher.first_name+" "+e.main_teacher.middle_name),data},generateTimeTable:function(){var e=this,t=[];this.TimeTabledic&&this.TimeTabledic.length&&this.TimeTableGroup&&this.TimeTableGroup.etimetablelesson&&this.TimeTableGroup.etimetablelesson.forEach((function(n){var data={weekday:n.weekday,current_day:n.current_day,timetable:[]};e.TimeTabledic.forEach((function(e){"Lesson"!=e.type?data.timetable.push({start_time:e.start_time,end_time:e.end_time,para:e.para,para_index:"",lesson:e.type,color:"color-"+e.type.toLowerCase(),subject_name:e.type,edit:!1,loading:!1,info:[]}):n.timetable.forEach((function(t){t.para==e.para&&data.timetable.push({id:t.id,start_time:e.start_time,end_time:e.end_time,para:e.para,para_index:t.para_index,lesson:t.lesson,subject_name:t.subject_name,color:"color-"+t.subject_name.charAt(0).toLowerCase(),main_teacher:t.main_teacher,teacher:t.timeTableList,edit:!1,loading:!1,delete:!1,type:"Lesson",info:t.info})}))})),t.push(data)})),this.timeTableList=t,this.loader=!1},SaveEdit:function(e,t,n,i,r){var l=this;if(n.lesson&&n.para){var data=new FormData;this.timeTableList[i].timetable[r].loading=!0,data.append("etimetable",e),data.append("lesson",n.lesson),data.append("para",n.para),data.append("weekday",t),n.id?this.$axios.put("/etimetablelesson/".concat(n.id,"/"),data).catch((function(){})).finally((function(){l.timeTableList[i].timetable[r].subject_name=l.GetSubjectByName(n,"subject_name"),l.timeTableList[i].timetable[r].main_teacher=l.GetSubjectByName(n,"main_teacher").first_name+" "+l.GetSubjectByName(n,"main_teacher").last_name+" "+l.GetSubjectByName(n,"main_teacher").middle_name,l.timeTableList[i].timetable[r].edit=!1,l.timeTableList[i].timetable[r].loading=!1,l.timeTableList[i].timetable=l.SortTimeTable(l.timeTableList[i].timetable)})):this.$axios.post("/etimetablelesson/",data).then((function(){l.timeTableList[i].timetable[r].start_time=l.GetDicPara(l.timeTableList[i].timetable[r],"start_time")})).catch((function(){})).finally((function(){l.timeTableList[i].timetable[r].subject_name=l.GetSubjectByName(n,"subject_name"),l.timeTableList[i].timetable[r].main_teacher=l.GetSubjectByName(n,"main_teacher").first_name+" "+l.GetSubjectByName(n,"main_teacher").last_name+" "+l.GetSubjectByName(n,"main_teacher").middle_name,l.timeTableList[i].timetable[r].edit=!1,l.timeTableList[i].timetable[r].loading=!1,l.timeTableList[i].timetable=l.SortTimeTable(l.timeTableList[i].timetable)}))}else this.$Swal.fire({title:"Please fill fields!",type:"warning",confirmButtonText:"Ok",confirmButtonClass:"btn btn-success mt-2"})},GetSubjectByName:function(e,t){if("Lesson"==e.type){var data=e[t];return this.Leesons.forEach((function(element){element.id==e.lesson&&(data=element[t])})),data}return e.lesson},DeleteTimeTableList:function(e,i,t){var n=this;e?(this.timeTableList[i].timetable[t].delete=!0,this.$axios.delete("/etimetablelesson/".concat(e,"/")).then((function(){n.timeTableList[i].timetable.splice(t,1)})).catch((function(){}))):this.timeTableList[i].timetable.splice(t,1)},SortTimeTable:function(e){return e.sort((function(a,b){return a.start_time>b.start_time?1:-1}))},AddTimeTable:function(i){this.timeTableList[i].timetable.push({start_time:"",end_time:"",para:"",lesson:"",subject_name:"",main_teacher:"",teacher:"",edit:!0,loading:!1,delete:!1,type:"Lesson"})},GetDicPara:function(e,t){var data="--:--";return e[t]?e[t]:e.para?(this.TimeTabledic.forEach((function(element){element.para==e.para&&(data=element[t])})),data):data},disabled_para_list:function(e){var data=[];return e.forEach((function(element){data.push(element.para)})),data},checkCurDate:function(e){if(["branch_admin"].includes(this.role))return!0;var t=new Date;return(t=o()(t).format("YYYY-MM-DD"))>=o()(this.formatDate(e)).format("YYYY-MM-DD")},formatDate:function(e){if(e){var a=e.split(".");return a=a[2]+"-"+a[1]+"-"+a[0]}},GoTopic:function(e){this.$router.push("".concat(e))},generatePara:function(e,t){var i=0;return this.TimeTabledic.forEach((function(element){"Lesson"!=element.type&&element.para<e&&(i+=1)})),t?e-i:e+i},Statusfinder:function(e){var data=!0;return e.forEach((function(element){element.studentwork||(data=!1)})),data}},mounted:function(){this.cur_semester&&(this.semester=this.cur_semester?this.cur_semester:this.semester_list[0].id),this.cur_academic_year&&(this.academic_year=this.cur_academic_year),this._gettimetableDic()}},h=(n(970),n(16)),component=Object(h.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"time-table-group"},[n("b-card-text",[n("header",{staticClass:"d-flex align-items-center justify-content-between mb-3"},[n("h4",{staticClass:"m-0"},[e._v("Timetable")]),e._v(" "),n("div",{staticClass:"d-flex align-items-center"},[n("el-select",{staticClass:"  foniy-select mr-1",attrs:{placeholder:"Academic year"},on:{change:function(t){return e._getList()}},model:{value:e.academic_year,callback:function(t){e.academic_year=t},expression:"academic_year"}},e._l(e.dic_academic_year,(function(t,i){return n("el-option",{key:i,attrs:{label:t.name,value:t.id,disabled:!e.checkCurDate(t.start_semester)}})})),1),e._v(" "),n("el-select",{staticClass:"  foniy-select mr-1",attrs:{placeholder:"Term"},model:{value:e.semester,callback:function(t){e.semester=t},expression:"semester"}},e._l(e.semester_list,(function(t,i){return n("el-option",{key:i,attrs:{label:i+1+"-term",value:t.id,disabled:!e.checkCurDate(t.start_semester)}})})),1)],1)]),e._v(" "),n("div",{staticClass:"time-table-view"},[e.timeTableList&&e.timeTableList.length&&!e.loader?n("div",{staticClass:"time-table-view-items"},e._l(e.timeTableList,(function(t,i){return n("div",{key:i,staticClass:"time-table-view-item foniy-table"},[n("div",{staticClass:"foniy-table"},[n("table",{staticClass:"border-all"},[n("tr",{class:t.current_day?"bg-promary-light":"bg-primary"},[n("th",{staticClass:"text-center font-weight-bold",attrs:{colspan:"4"}},[e._v(e._s(t.weekday)+" ")])]),e._v(" "),n("tr",{staticClass:"bg-gray"},[n("th",{staticClass:"text-center font-weight-bold",staticStyle:{width:"130px"}},[e._v(" No")]),e._v(" "),n("th",{staticClass:"text-center font-weight-bold"},[e._v("Lesson ")]),e._v(" "),n("th",{staticClass:"text-center font-weight-bold",staticStyle:{width:"200px"}},[e._v("Teacher ")]),e._v(" "),n("th",{staticClass:"text-center font-weight-bold",staticStyle:{width:"130px"}},[e._v("Start/End ")])]),e._v(" "),e._l(t.timetable,(function(t,r){return n("tr",{key:r},[n("td",{staticClass:"text-center"},[t.edit?e._e():n("p",{staticClass:"m-0 d-block"},["Lesson"==t.type?n("span",{staticClass:"font-weight-bold d-block"},[e._v(" "+e._s(e.generatePara(t.para,!0))+" ")]):e._e()])]),e._v(" "),n("td",[n("div",{staticClass:"d-flex  justify-content-center"},[t.edit?e._e():n("div",{staticClass:"m-0 timte-table-lesson"},[t.info&&t.info.length?n("div",{staticClass:"badge",class:{"color-green":!e.Statusfinder(t.info)}},[e._v(" "+e._s(t.info.length)+" ")]):e._e(),e._v(" "),t.info&&t.info.length&&!e.id?n("el-dropdown",{on:{command:e.GoTopic}},[n("span",{staticClass:"el-dropdown-link font-weight-bold general-lesson-name",class:t.color},["Lunch"==t.lesson?n("i",{staticClass:"mdi mdi-coffee mr-1"}):e._e(),e._v(" "),"Snack"==t.lesson?n("i",{staticClass:"mdi mdi-cupcake mr-1"}):e._e(),e._v("\n                                                    "+e._s(t.subject_name)+" \n                                                ")]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(t.info,(function(r,s){return n("el-dropdown-item",{key:s,attrs:{command:"/lessons/in-group/assignment/"+r.id+"?lesson="+t.lesson+"&lesson_name="+t.subject_name+"&topic="+r.topic+"&topic_name="+r.title}},[n("p",{staticClass:"m-0 deadline-text"},[e._v(e._s(r.title)+"  "),n("span",{staticClass:"font-10",class:{"color-green":r.studentwork}},[e._v(e._s(r.due_date_time))])])])})),1)],1):n("span",{staticClass:"font-weight-bold general-lesson-name",class:t.color},["Lunch"==t.lesson?n("i",{staticClass:"mdi mdi-coffee mr-1"}):e._e(),e._v(" "),"Snack"==t.lesson?n("i",{staticClass:"mdi mdi-cupcake mr-1"}):e._e(),e._v("\n                                                "+e._s(t.subject_name)+"\n                                            ")])],1)])]),e._v(" "),n("td",{staticClass:"text-center font-weight-bold"},[t.main_teacher?n("span",{staticClass:"font-14 pt-1 ml-2 color-primary"},[e._v(" "+e._s(t.main_teacher)+" ")]):e._e()]),e._v(" "),n("td",{staticClass:"text-center font-weight-bold"},[n("p",{staticClass:"time-colors"},[e._v(" "+e._s(e.GetDicPara(t,"start_time"))+" / "+e._s(e.GetDicPara(t,"end_time"))+" ")])])])})),e._v(" "),["branch_admin"].includes(e.role)&&t.timetable&&e.TimeTabledic&&t.timetable.length<e.TimeTabledic.length?n("tr",[n("td",{attrs:{colspan:"4"}},[n("b-button",{staticClass:"ml-1 font-20 font-weight-bold w-full",attrs:{size:"md",variant:"outline-success"},on:{click:function(t){return e.AddTimeTable(i)}}},[n("i",{staticClass:"mdi mdi-plus-circle"})])],1)]):e._e()],2)])])})),0):e._e(),e._v(" "),e.loader?n("div",{staticClass:"table-loader",staticStyle:{height:"300px"}},[n("i",{staticClass:"el-icon-loading"}),e._v(" "),n("p",{staticClass:"m-0 mt-1"},[e._v("loading...")])]):e._e(),e._v(" "),!e.timeTableList||e.timeTableList.length||e.loader?e._e():n("div",{staticClass:"empty-time-table"},[n("p",{staticClass:"text-center"},[n("i",{staticClass:"mdi mdi-timer-outline font-20"}),e._v(" "),n("br"),e._v("\n                    Timetable has not created this group yet!\n                ")])])])])],1)}),[],!1,null,null,null);t.default=component.exports}}]);