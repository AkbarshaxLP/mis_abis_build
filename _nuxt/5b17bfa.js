(window.webpackJsonp=window.webpackJsonp||[]).push([[222],{1019:function(t,e,n){"use strict";n(977)},1020:function(t,e,n){var c=n(52)(!1);c.push([t.i,'.group-view-header[data-v-1b359366]{display:flex;align-items:center}.group-view-header h1[data-v-1b359366]{font-family:"Roboto";font-style:normal;font-weight:700;font-size:18px;line-height:21px;color:#2b2d33;flex:1}.students-list-table tbody td p[data-v-1b359366]{margin-bottom:4px;font-style:normal;font-weight:400;font-size:14px;line-height:16px;color:#2b2d33}.students-list-table tbody td span[data-v-1b359366]{font-family:"Roboto";font-style:normal;font-weight:400;font-size:13px;line-height:16px;color:#90999d}',""]),t.exports=c},1109:function(t,e,n){"use strict";n.r(e);var c=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",{attrs:{rowspan:"2"}},[n("p",{staticClass:"font-16 text-muted m-0"},[t._v("Students")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",{attrs:{colspan:"4"}},[n("p",{staticClass:"font-16 text-muted m-0"},[t._v("Total")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("th",{staticClass:"bg-gray",staticStyle:{width:"50px"}},[n("p",{staticClass:"font-14 text-center m-0 font-weight-bold color-green"},[t._v("\n                            P\n                        ")])]),t._v(" "),n("th",{staticClass:"bg-gray",staticStyle:{width:"50px"}},[n("p",{staticClass:"font-14 text-center m-0 font-weight-bold color-red"},[t._v("\n                            A\n                        ")])]),t._v(" "),n("th",{staticClass:"bg-gray",staticStyle:{width:"50px"}},[n("p",{staticClass:"font-14 text-center m-0 font-weight-bold color-orange"},[t._v("\n                            L\n                        ")])]),t._v(" "),n("th",{staticClass:"bg-gray",staticStyle:{width:"50px"}},[n("p",{staticClass:"font-14 text-center m-0 font-weight-bold"},[t._v("E")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"user-table-image"},[e("img",{attrs:{src:n(843),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"mr-1 font-16 font-weight-bold cursor-pointer"},[e("i",{staticClass:"mdi mdi-close-thick"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"mr-2"},[n("span",{staticClass:"color-green font-weight-bold"},[t._v("P")]),t._v(" "),n("span",{staticClass:"text-muted"},[t._v("-Present")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"mr-2"},[n("span",{staticClass:"color-red font-weight-bold"},[t._v("A")]),t._v(" "),n("span",{staticClass:"text-muted"},[t._v("-Absent")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"mr-2"},[n("span",{staticClass:"color-orange font-weight-bold"},[t._v("L")]),t._v(" "),n("span",{staticClass:"text-muted"},[t._v("-Late")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"mr-2"},[n("span",{staticClass:"font-weight-bold"},[t._v("E")]),t._v(" "),n("span",{staticClass:"text-muted"},[t._v("-Excused")])])}],r=(n(2),n(14),n(6),n(12),n(25),n(22),n(5)),d=n.n(r),o={data:function(){return{loading:!1,studentList:[],colors:{Absent:"red",Present:"green",Late:"orange",Excused:"black",N:""},attandanceList:[],attandanceType:[],semester:1,current_semester:"",weekDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],week:1,semesterList:[],semesterStart:"2022-09-19",semesterEnd:"2022-09-19"}},watch:{semester:function(){this._GET(),this.GetSemesterDate()},week:function(){this._GET()}},mounted:function(){this._getAttandanceType(),this._getsemester()},methods:{pageChanged:function(){this._GET()},_GET:function(){var t=this;0==this.attandanceList.length&&(this.loading=!0),this.$axios.get("/attendancelist/?lesson=".concat(this.$route.params.id,"&week=").concat(this.week,"&semester=").concat(this.semester)).then((function(e){t.attandanceList=[];var a=[];e.data.data&&e.data.data.forEach((function(element){a=[],element.attendance.forEach((function(e){e.attendance&&e.attendance.attendance_status_id?a.push({id:e.attendance.id,attendance_status_id:e.attendance.attendance_status_id,attendance_status:t.getName(e.attendance.attendance_status_id),edit:!1}):a.push({id:"",attendance_status_id:"",attendance_status:"",edit:!1})})),t.attandanceList.push(a)})),t.studentList=e.data.data})).finally((function(){t.loading=!1}))},_getAttandanceType:function(){var t=this;this.$axios.get("/attendance_status/").then((function(e){t.attandanceType=e.data}))},_getsemester:function(){var t=this;this.$axios.get("/semesterlist/?lesson=".concat(this.$route.params.id)).then((function(e){t.semesterList=e.data,t.semester=e.data[0].id,t.current_semester=e.data[0].id,t.semesterStart=t.formatDate(e.data[0].start_semester),t.semesterEnd=t.formatDate(e.data[0].end_semester),e.data.forEach((function(element){element.current_semester&&(t.semester=element.id,t.current_semester=element.id,t.semesterStart=t.formatDate(element.start_semester),t.semesterEnd=t.formatDate(element.end_semester))}))}))},_getDay:function(t){return t.split("-")[2]},_getWeek:function(t){var e=d()(t).format("YYYY-MM-DD");return(e=new Date(e)).getDay()},formatDate:function(t){var a=t.split(".");return a=a[2]+"-"+a[1]+"-"+a[0]},getFirstLetter:function(a){return a?a.charAt(0):null},getName:function(t){var a="";return this.attandanceType.forEach((function(element){element.id==t&&(a=element.name)})),a},getId:function(t){var a="";return this.attandanceType.forEach((function(element){element.name==t&&(a=element.id)})),a},markStudent:function(i,t,e){var n=this,c=this.studentList[i].attendance[t].attendance?this.studentList[i].attendance[t].attendance.id:null;console.log(c);var data=new FormData;data.append("semester",this.semester),data.append("lesson",this.$route.params.id),data.append("attendance_date",this.studentList[i].attendance[t].attendance_date),data.append("attendance_students[0]student",e),data.append("attendance_students[0]attendance_status",this.attandanceList[i][t].attendance_status_id),this.$axios({method:"POST",url:"/attendance/",data:data}).then((function(){n._GET()})),this.attandanceList[i][t].edit=!1,this.studentList[i].attendance[t].attendance=this.attandanceList[i][t]},changeMark:function(i,t){this.attandanceList[i][t].attendance_status=this.getName(this.attandanceList[i][t].attendance_status_id)},markEdit:function(i,t){this.attandanceList[i][t].edit=!0},GetSemesterDate:function(){var t=this;this.week=1,this.semesterList.forEach((function(element){element.id==t.semester&&(t.semesterStart=t.formatDate(element.start_semester),t.semesterEnd=t.formatDate(element.end_semester))}))},checkCurDate:function(t){var e=new Date;return(e=d()(e).format("YYYY-MM-DD"))>=d()(this.formatDate(t)).format("YYYY-MM-DD")}},middleware:"auth"},l=(n(1019),n(16)),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"table-responsive mb-0"},[n("header",{staticClass:"mb-3"},[n("h4",[t._v("Attendance")]),t._v(" "),n("div",{staticClass:"d-flex justify-content-between pt-2"},[n("div",[n("el-select",{staticClass:"foniy-select w-full",attrs:{placeholder:"Select"},model:{value:t.semester,callback:function(e){t.semester=e},expression:"semester"}},t._l(t.semesterList,(function(e,i){return n("el-option",{key:i,attrs:{label:i+1+"-term",value:e.id,disabled:!t.checkCurDate(e.start_semester)}})})),1)],1),t._v(" "),n("weekPagination",{attrs:{start:t.semesterStart,end:t.semesterEnd},model:{value:t.week,callback:function(e){t.week=e},expression:"week"}})],1)]),t._v(" "),t.loading?t._e():n("div",{staticClass:"foniy-table mb-3 "},[t.studentList&&t.studentList[0]?n("table",{staticClass:"border-all"},[n("tr",{staticClass:"vertical-bottom"},[t._m(0),t._v(" "),t._l(t.studentList[0].attendance,(function(e,i){return n("th",{key:i,staticStyle:{width:"150px"},attrs:{rowspan:"2"}},[n("div",{staticClass:"week-day",class:{active:e.current_day}},[n("p",[t._v(" "+t._s(t.weekDays[t._getWeek(e.attendance_date)]))]),t._v(" "),n("div",{staticClass:"cricle-number"},[t._v(" "+t._s(t._getDay(e.attendance_date))+" ")])])])})),t._v(" "),t._m(1)],2),t._v(" "),t._m(2),t._v(" "),t._l(t.studentList,(function(e,i){return n("tr",{key:i},[n("td",[n("div",{staticClass:"student-name-imame"},[t._m(3,!0),t._v(" "),n("h1",{staticClass:"font-14 font-weight-normal m-0"},[t._v("\n                                "+t._s(e.last_name)+" "+t._s(e.first_name)+"\n                            ")])])]),t._v(" "),t._l(e.attendance,(function(c,r){return n("td",{key:r,staticClass:"mark-controls"},[c.next_day||t.current_semester!=t.semester?t._e():n("div",[t._v("\n                            "+t._s(c.nex_day)+"\n                            "),!c.attendance&&c.current_day||t.attandanceList[i][r].edit||c.attendance&&!c.attendance.attendance_status_id&&c.current_day?n("div",{staticClass:"d-flex align-items-center justify-content-center "},[n("el-select",{staticClass:"foniy-select font-weight-bold mr-1",class:"color-"+t.colors[t.attandanceList[i][r].attendance_status],staticStyle:{width:"60px"},attrs:{placeholder:""},on:{change:function(e){return t.changeMark(i,r)}},model:{value:t.attandanceList[i][r].attendance_status_id,callback:function(e){t.$set(t.attandanceList[i][r],"attendance_status_id",e)},expression:"attandanceList[i][j].attendance_status_id"}},t._l(t.attandanceType,(function(e,c){return n("el-option",{key:c,attrs:{value:e.id,label:""+t.getFirstLetter(e.name)}},[n("p",{staticClass:"font-14 m-0 font-weight-bold ",class:"color-"+t.colors[e.name]},[t._v(" "+t._s(t.getFirstLetter(e.name)))])])})),1),t._v(" "),n("span",{staticClass:"mr-1 font-16 font-weight-bold cursor-pointer",on:{click:function(n){return t.markStudent(i,r,e.id)}}},[n("i",{staticClass:"mdi mdi-check-bold"})]),t._v(" "),t._m(4,!0)],1):t._e(),t._v(" "),c.attendance&&c.attendance.attendance_status_id&&!t.attandanceList[i][r].edit||!c.current_day&&!t.attandanceList[i][r].edit&&!t.attandanceList[i][r].id?n("div",{staticClass:"d-flex align-items-center justify-content-center"},[c.attendance?n("p",{staticClass:"font-14 text-center m-0 font-weight-bold",class:"color-"+t.colors[c.attendance.attendance_status]},[t._v(" "+t._s(t.getFirstLetter(c.attendance.attendance_status))+" ")]):t._e(),t._v(" "),n("span",{staticClass:"ml-2 font-16 cursor-pointer font-weight-bold mark-edit",on:{click:function(e){return t.markEdit(i,r)}}},[n("i",{staticClass:"mdi mdi-border-color"})])]):t._e()])])})),t._v(" "),n("td",{staticClass:"bg-gray"},[n("p",{staticClass:"font-14 text-center m-0 font-weight-normal"},[t._v("\n                            "+t._s(e.total_p)+"\n                        ")])]),t._v(" "),n("td",{staticClass:"bg-gray"},[n("p",{staticClass:"font-14 text-center m-0 font-weight-normal"},[t._v(" "+t._s(e.total_a)+" ")])]),t._v(" "),n("td",{staticClass:"bg-gray"},[n("p",{staticClass:"font-14 text-center m-0 font-weight-normal"},[t._v(" "+t._s(e.total_l)+" ")])]),t._v(" "),n("td",{staticClass:"bg-gray"},[n("p",{staticClass:"font-14 text-center m-0 font-weight-normal"},[t._v(t._s(e.total_e)+" ")])])],2)}))],2):t._e()]),t._v(" "),t.loading?t._e():n("div",{staticClass:"d-flex flex-wrap-wrap"},[t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8)]),t._v(" "),t.loading?n("div",{staticClass:"table-loader",staticStyle:{height:"500px"}},[n("i",{staticClass:"el-icon-loading"}),t._v(" "),n("p",{staticClass:"m-0 mt-1"},[t._v("loading...")])]):t._e()])])}),c,!1,null,"1b359366",null);e.default=component.exports},843:function(t,e,n){t.exports=n.p+"img/default-avatar.26ed590.svg"},977:function(t,e,n){var content=n(1020);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(53).default)("39b1bc82",content,!0,{sourceMap:!1})}}]);