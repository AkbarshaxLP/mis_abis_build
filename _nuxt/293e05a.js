(window.webpackJsonp=window.webpackJsonp||[]).push([[241,41],{1449:function(t,e,r){"use strict";r.r(e);r(7),r(9),r(6),r(10);var n=r(0),o=(r(22),r(12),r(24),r(4),r(2),r(25),r(256),r(8),r(21),r(35));function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function c(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d={data:function(){return{loading:!1,form:{branch_admin:{phone:"",first_name:"",last_name:"",middle_name:"",passport_serial:"",description:""},short_name:"",legal_name:"",stir:null,phone_number:"",address:"",description:"",website:"",branch_email:"",location:null,status:!0,region:null,district:null,organization_type:null},title:"School Branches",items:[{text:"School Branches",active:!0}]}},computed:c(c({},Object(o.b)("dictionary",["dic_region","dic_district"])),{},{is_main_branch:function(){return this.$store.state.auth.user.is_main_branch},role:function(){var t;return null===(t=this.$store.state.auth.user)||void 0===t?void 0:t.role.name}}),created:function(){this.__GET()},methods:{save:function(){var t=this;this.$refs.form.validate().then((function(e){if(e){t.loading=!0;var r=t.form.id,n=r?r+"/":"",data=c({},t.form);data.phone_number=t.form.phone_number?t.form.phone_number.replace(/\D/g,""):"",data.branch_admin.phone=t.form.branch_admin.phone?t.form.branch_admin.phone.replace(/\D/g,""):"";var o=[];data.location.split(",").filter((function(t){o.push(Number(t))})),data.location=o,t.$axios({url:"/branch/"+n,method:r?"PATCH":"POST",data:data}).then((function(e){t.$Swal.fire({title:t.form.id?"Edited!":"Created!",type:"success"}).then((function(e){t.$router.push("/schools")}))})).catch((function(e){var r=e.response.data,n=r[Object.keys(r)[0]];t.$Swal.fire({title:"Ошибка",text:n||"Error",type:"error"})})).finally((function(){t.loading=!1}))}}))},__GET:function(){var t=this,e=this.$route.params.id;e&&(this.loading=!0,this.$axios({url:"/branch/".concat(e),method:"GET"}).then((function(e){t.form=e.data,t.form.location=t.form.location?t.form.location.join(","):""})).catch((function(e){var r=e.response.data,n=r[Object.keys(r)[0]];t.$Swal.fire({title:"Ошибка",text:n||"Error",type:"error"})})).finally((function(){t.loading=!1})))}}},m=r(16),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[r("PageHeader",{attrs:{title:t.title,items:t.items}}),t._v(" "),r("div",{staticClass:"card"},[r("div",{staticClass:"card-body"},[r("ValidationObserver",{ref:"form"},[r("h4",{staticClass:"header-title mb-2"},[t._v("School branch data")]),t._v(" "),r("div",{staticClass:"row school-create-form"},[r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("School short name")]),t._v(" "),r("b-input",{class:{invalid:n[0]},attrs:{type:"text"},model:{value:t.form.short_name,callback:function(e){t.$set(t.form,"short_name",e)},expression:"form.short_name"}})]}}])})],1)]),t._v(" "),r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Type of organization:*")]),t._v(" "),r("b-select",{class:{invalid:n[0]},attrs:{type:"text"},model:{value:t.form.organization_type,callback:function(e){t.$set(t.form,"organization_type",e)},expression:"form.organization_type"}},[r("option",{domProps:{value:1}},[t._v("School")])])]}}])})],1)]),t._v(" "),r("div",{staticClass:"col-md-12"},[r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Legal name:*")]),t._v(" "),r("b-input",{class:{invalid:n[0]},attrs:{type:"text"},model:{value:t.form.legal_name,callback:function(e){t.$set(t.form,"legal_name",e)},expression:"form.legal_name"}})]}}])})],1)]),t._v(" "),r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required|length:10"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("STIR (ИНН):")]),t._v(" "),r("b-input",{directives:[{name:"mask",rawName:"v-mask",value:"##########",expression:"'##########'"}],class:{invalid:n[0]},attrs:{type:"text"},model:{value:t.form.stir,callback:function(e){t.$set(t.form,"stir",e)},expression:"form.stir"}})]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Region:")]),t._v(" "),r("b-select",{class:{invalid:n[0]},attrs:{type:"text"},model:{value:t.form.region,callback:function(e){t.$set(t.form,"region",e)},expression:"form.region"}},t._l(t.dic_region,(function(e){return r("option",{key:e.id,attrs:{label:e.name},domProps:{value:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])})),0)]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("District (city):")]),t._v(" "),r("b-select",{class:{invalid:n[0]},attrs:{disabled:!t.form.region,placeholder:"Choose...",type:"text"},model:{value:t.form.district,callback:function(e){t.$set(t.form,"district",e)},expression:"form.district"}},t._l(t.dic_district,(function(e){return r("option",{key:e.id,attrs:{label:e.name},domProps:{value:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])})),0)]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Address:")]),t._v(" "),r("b-textarea",{class:{invalid:n[0]},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})]}}])})],1)]),t._v(" "),r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Website:")]),t._v(" "),r("b-input",{class:{invalid:n[0]},attrs:{placeholder:"E.g. www.site.com",type:"text"},model:{value:t.form.website,callback:function(e){t.$set(t.form,"website",e)},expression:"form.website"}})]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("E-Mail:")]),t._v(" "),r("b-input",{class:{invalid:n[0]},attrs:{placeholder:"E.g. abis@gmail.com",type:"text"},model:{value:t.form.branch_email,callback:function(e){t.$set(t.form,"branch_email",e)},expression:"form.branch_email"}})]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Phone number:*")]),t._v(" "),r("input",{directives:[{name:"mask",rawName:"v-mask",value:"+998 (##) ###-##-##",expression:"'+998 (##) ###-##-##'"},{name:"model",rawName:"v-model",value:t.form.phone_number,expression:"form.phone_number"}],staticClass:"form-control",class:{invalid:n[0]},domProps:{value:t.form.phone_number},on:{input:function(e){e.target.composing||t.$set(t.form,"phone_number",e.target.value)}}})]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Location:")]),t._v(" "),r("b-input",{class:{invalid:n[0]},attrs:{placeholder:"Lat, Long",type:"text"},model:{value:t.form.location,callback:function(e){t.$set(t.form,"location",e)},expression:"form.location"}})]}}])})],1)])]),t._v(" "),r("hr"),t._v(" "),r("h4",{staticClass:"header-title mb-2"},[t._v("Director data")]),t._v(" "),r("div",{staticClass:"row school-create-form bg-light py-2"},[r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Last Name:*")]),t._v(" "),r("b-input",{class:{invalid:n[0]},attrs:{type:"text"},model:{value:t.form.branch_admin.last_name,callback:function(e){t.$set(t.form.branch_admin,"last_name",e)},expression:"form.branch_admin.last_name"}})]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",[r("p",{staticClass:"mb-1"},[t._v("Middle Name:")]),t._v(" "),r("b-input",{attrs:{type:"text"},model:{value:t.form.branch_admin.middle_name,callback:function(e){t.$set(t.form.branch_admin,"middle_name",e)},expression:"form.branch_admin.middle_name"}})],1)],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Phone number:*")]),t._v(" "),r("input",{directives:[{name:"mask",rawName:"v-mask",value:"+998 (##) ###-##-##",expression:"'+998 (##) ###-##-##'"},{name:"model",rawName:"v-model",value:t.form.branch_admin.phone,expression:"form.branch_admin.phone"}],staticClass:"form-control",class:{invalid:n[0]},attrs:{type:"text"},domProps:{value:t.form.branch_admin.phone},on:{input:function(e){e.target.composing||t.$set(t.form.branch_admin,"phone",e.target.value)}}})]}}])})],1)]),t._v(" "),r("div",{staticClass:"col-md-6"},[r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("First Name:*")]),t._v(" "),r("b-input",{class:{invalid:n[0]},attrs:{type:"text"},model:{value:t.form.branch_admin.first_name,callback:function(e){t.$set(t.form.branch_admin,"first_name",e)},expression:"form.branch_admin.first_name"}})]}}])})],1),t._v(" "),r("div",{staticClass:"item"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Passport Seria and Number:*")]),t._v(" "),r("b-input",{directives:[{name:"mask",rawName:"v-mask",value:"AA#######",expression:"'AA#######'"}],class:{invalid:n[0]},attrs:{placeholder:"AA1234567",type:"text"},model:{value:t.form.branch_admin.passport_serial,callback:function(e){t.$set(t.form.branch_admin,"passport_serial",e)},expression:"form.branch_admin.passport_serial"}})]}}])})],1)])])]),t._v(" "),t.is_main_branch||["super_admin"].includes(t.role)?r("div",{staticClass:"text-right mt-3"},[r("b-button",{attrs:{size:"md"},on:{click:function(e){return t.cancel()}}},[t._v(" Cancel ")]),t._v(" "),r("b-button",{attrs:{size:"md",variant:"success"},on:{click:function(e){return t.save()}}},[t._v("\n          Save\n        ")])],1):t._e()],1)])],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{PageHeader:r(837).default})},837:function(t,e,r){"use strict";r.r(e);var n=r(35),o={components:{},props:{title:{type:String,default:""},items:{type:Array,default:function(){return[]}}},computed:Object(n.c)(["layout"])},l=r(16),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"row"},[r("div",{staticClass:"col-12"},[r("div",{staticClass:"page-title-box",class:{"page-title-box-alt":"vertical"!==t.layout.layoutType&&"two-column"!==t.layout.layoutType}},[r("h4",{staticClass:"page-title"},[t._v(t._s(t.title))]),t._v(" "),r("div",{staticClass:"page-title-right"},[r("b-breadcrumb",{staticClass:"m-0",attrs:{items:t.items}})],1)])])])}),[],!1,null,null,null);e.default=component.exports}}]);