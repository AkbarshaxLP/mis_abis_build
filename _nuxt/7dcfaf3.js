(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{1126:function(t,e,n){"use strict";n.r(e);n(7),n(9),n(6),n(10);var r=n(0),o=(n(4),n(2),n(47),n(68),n(17),n(22),n(8),n(35)),c=n(840);function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var d={props:["showDialog","modalId"],computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(o.b)("dictionary",["dic_department","dic_language"])),data:function(){return{show:!1,loading:!1,dialog:!1,editMethod:!1,form:{id:null,name:"",department_i18n:[]}}},watch:{show:function(t){this.editMethod||(this.form={id:null,name:"",department_i18n:[]}),t||(this.editMethod=!1),this.setLang("department_i18n")},dic_language:{handler:function(t){this.setLang("department_i18n")},deep:!0}},mounted:function(){this.setLang("department_i18n")},methods:{setLang:function(t){var e=this;this.dic_language.filter((function(n){e.form[t]||(e.form[t]=[]),e.form[t].map((function(t){return t.language})).includes(n.id)||e.form[t].push({language:n.id,name:"",description:""})}))},clearForm:function(){this.form={id:null,name:"",department_i18n:[]}},langTitle:function(t){var a=this.dic_language.filter((function(e){return e.id==t}))[0];return a?a.name:""},setForm:function(t){this.form=Object(c.a)(t)},beforeClose:function(){this.form={id:null,name:"",department_i18n:[]},this.$emit("dialog",!1)},save:function(){var t=this;this.$refs.form1.validate().then((function(e){if(e){t.loading=!0;var n=t.form.id,r=n?n+"/":"";t.$axios({url:"/department/"+r,method:n?"PATCH":"POST",data:t.form}).then((function(e){t.fetchItems(),t.$bvModal.hide(t.modalId)})).catch((function(e){var n=e.response.data,r=n[Object.keys(n)[0]];t.$notify.error({message:r||"Произошла ошибка"})})).finally((function(){t.loading=!1}))}}))},fetchItems:function(){this.$store.dispatch("dictionary/dic_department")},deleteItem:function(){var t=this;this.$confirm("Вы точно хотите удалить?",{confirmButtonText:"Да",cancelButtonText:"Отмена",type:"warning"}).then((function(){t.loading=!0;var e=t.form.id,n=e?e+"/":"";t.$axios.delete("/department/"+n).then((function(){t.fetchItems(),t.$message({type:"success",message:"Deleted"})})).finally((function(){t.loading=!1}))}))}}},f=d,m=n(16),component=Object(m.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[t.dic_department.length?r("table",{staticClass:"table"},[r("tbody",t._l(t.dic_department,(function(e,o){return r("tr",{key:o+1},[r("td",{staticStyle:{width:"20px"}},[t._v(t._s(o+1))]),t._v(" "),r("td",[t._v(t._s(e.name))]),t._v(" "),r("td",{staticStyle:{width:"50px"}},[r("div",{staticClass:"actions"},[r("img",{staticClass:"cursor-pointer mr-2",attrs:{src:n(839)},on:{click:function(n){t.$bvModal.show(t.modalId),t.editMethod=!0,t.setForm(e)}}}),t._v(" "),r("i",{staticClass:"el-icon-delete cursor-pointer text-red-600",on:{click:function(n){t.form.id=e.id,t.form.name=e.name,t.deleteItem()}}})])])])})),0)]):r("div",{staticClass:"d-flex py-4"},[r("img",{staticClass:"mx-auto",attrs:{src:n(841)}})]),t._v(" "),r("b-modal",{attrs:{id:t.modalId,title:"Add Department","title-class":"font-18","body-class":"p-4"},on:{hide:function(e){return t.clearForm()}},scopedSlots:t._u([{key:"modal-footer",fn:function(e){var n=e.cancel;return[r("b-button",{attrs:{size:"md"},on:{click:function(t){return n()}}},[t._v(" Cancel ")]),t._v(" "),r("b-button",{attrs:{size:"md",variant:"success"},on:{click:function(e){return t.save()}}},[t._v(" Save ")])]}}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("ValidationObserver",{ref:"form1"},[r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Name")]),t._v(" "),r("b-form-input",{staticClass:"mb-2",class:{invalid:n[0]},attrs:{type:"text",placeholder:"Name"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})]}}])}),t._v(" "),r("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors;return[r("p",{staticClass:"mb-1"},[t._v("Order")]),t._v(" "),r("b-form-input",{staticClass:"mb-2",class:{invalid:n[0]},attrs:{type:"number",placeholder:"Order"},model:{value:t.form.order,callback:function(e){t.$set(t.form,"order",e)},expression:"form.order"}})]}}])}),t._v(" "),t._l(t.form.department_i18n,(function(e,n){return r("ValidationProvider",{key:n,attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(n){var o=n.errors;return[r("p",{staticClass:"mb-1"},[t._v("Name "+t._s(t.langTitle(e.language)))]),t._v(" "),r("b-form-input",{staticClass:"mb-2",class:{invalid:o[0]},attrs:{type:"text",placeholder:"Name "+t.langTitle(e.language)},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item.name"}})]}}],null,!0)})})),t._v(" "),t._l(t.form.department_i18n,(function(e,n){return r("ValidationProvider",{key:n,attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(n){var o=n.errors;return[r("p",{staticClass:"mb-1"},[t._v("Description "+t._s(t.langTitle(e.language)))]),t._v(" "),r("b-form-input",{staticClass:"mb-2",class:{invalid:o[0]},attrs:{type:"text",placeholder:"Description "+t.langTitle(e.language)},model:{value:e.description,callback:function(n){t.$set(e,"description",n)},expression:"item.description"}})]}}],null,!0)})}))],2)],1)],1)}),[],!1,null,null,null);e.default=component.exports},839:function(t,e,n){t.exports=n.p+"img/pen.8d1d161.svg"},840:function(t,e,n){"use strict";var r=n(26);n(256),n(2),n(6);e.a=function t(e){if(!e)return e;var n;if([Number,String,Boolean].forEach((function(t){e instanceof t&&(n=t(e))})),void 0===n)if("[object Array]"===Object.prototype.toString.call(e))n=[],e.forEach((function(e,r,o){n[r]=t(e)}));else if("object"==Object(r.a)(e))if(e.nodeType&&"function"==typeof e.cloneNode)n=e.cloneNode(!0);else if(e.prototype)n=e;else if(e instanceof Date)n=new Date(e);else for(var i in n={},e)n[i]=t(e[i]);else n=e;return n}},841:function(t,e,n){t.exports=n.p+"img/empty.1b64caa.svg"}}]);